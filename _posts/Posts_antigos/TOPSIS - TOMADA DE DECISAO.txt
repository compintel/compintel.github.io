2016-08-02

Ao longo de nossas vidas somos obrigados a tomar uma série de decisões, algumas fáceis e outras extremamente difíceis. Seja fácil ou difícil, para se fazer uma escolha, normalmente, temos alternativas a serem escolhidas de acordo com um conjunto de critérios pré definidos. Um exemplo simples pode ser escolher um carro para comprar. A maioria das pessoas leva em consideração o preço, potência do motor, reputação da montadora, conforto, etc. Esses, nada mais são que nossos critérios para escolher um carro e baseado neles, avaliamos nossas alternativas, que poderiam ser um Hb20, um Pálio ou um Corola, dependendo, é claro, de quais os critérios são os mais importantes para cada pessoa. Agora imagine uma decisão mais complexa de ser tomada, como por exemplo, onde investir uma certa quantidade de dinheiro. Já imaginou um algoritmo que possa te auxiliar nessa decisão?

Problemas de tomada de decisão multi-critério (do inglês, <em>multi-criteria decision making</em>, abreviado por MCDM) são caracterizados por uma matriz de decisão, que é composta de alternativas e critérios ponderados de acordo com o tomador de decisão em questão. Métodos para solucionar problemas MCDM como têm sido amplamente utilizados para selecionar a melhor alternativa entre um número finito de alternativas. Como exemplo de métodos, podemos citar PROMETHEE [1], TODIM [2] e o TOPSIS [3], que será o tema deste post.

O algoritmo TOPSIS (do inglês, <em>Technique for Order Preference by Similarity to Ideal Solution</em>) foi desenvolvido por Hwang &amp; Yoon [3] e é uma técnica de avaliação de performances de alternativas através da similaridade da mesma com uma solução ideal. De acordo com essa técnica a melhor alternativa é aquela mais próxima da solução ideal e mais distante da solução não ideal. O TOPSIS é muito utilizado para solucionar problemas de tomada de decisão da vida real, como nosso exemplo da escolha do carro. Além disso, existem variações do algoritmo que utilizam lógica <em>fuzzy</em> e lógica <em>fuzzy </em>intuicionista [4] [5], mas isso são assuntos para um próximo post.

A seguir serão definidos os conceitos básicos e o algoritmo de tomada de decisão TOPSIS.
<h3>Tomada de decisão de multi-critério</h3>
Vamos considerar uma matriz D, no qual consiste de alternativas e critérios, descrita por:

<a href="http://www.computacaointeligente.com.br/wp-content/uploads/2016/04/matD.png"><img class="aligncenter  wp-image-296" src="http://www.computacaointeligente.com.br/wp-content/uploads/2016/04/matD.png" alt="matD" width="221" height="124" /></a>

no qual [latex]A_{1}, A_{2} \cdots A_{m}[/latex] são as alternativas viáveis, [latex]C_{1}, C_{2} \cdots C_{m}[/latex] são os critérios, [latex]x_{ij}[/latex]<em> indica</em> o rating, o desempenho, da alternativa $latex A_{1}$ com respeito ao critério $latex C_{j}$. Cada critério possui um determinado peso, definido pelo tomador de decisão em questão (pode ser eu, você, um amigo...), representado pelo vetor $latex W = (w_{1}, w_2, \cdots , w_n)$, sendo $latex w_j$ um peso para o critério $latex C_j$ satisfazendo $latex \sum_{j=1}^n w_j = 1$.

Em geral os critérios são classificados em dois tipos (e isso é muito importante). Critérios de custo, quanto, menor o <em>rating </em>dele melhor, e critérios de benefício, quanto maior o <em>rating</em> melhor. Voltando ao nosso exemplo da compra do carro, o preço é um critério de custo, ou seja, quanto menor o preço, mais desejável é o carro. Por outro lado, o conforto é um critério de benefício, ou seja, quanto maior, melhor.

A matriz D, depois de preenchida, necessita ser normalizada em uma matriz $latex R = [r_{ij}]_{mxn}$, isso permite a comparação entre todos os critérios (imagine, o preço dos carros estão em um intervalo menor do que uma nota de 0 a 10 dada para o conforto, por exemplo). Para normalizar basta fazer:
<p style="text-align: center;">[latex]
r_{ij} = \frac{x_{ij}}{\sqrt{\sum_{i=1}^m x^2_{ij}}}
[/latex]</p>
<p style="text-align: left;">Por fim, após a normalização dos <em>ratings</em>, os valores da matriz R deve ser ponderados pelo vetor W, gerando uma nova matriz $latex P = [p_{ij}]_{mxn}$, oriunda da seguinte multiplicação de:</p>
<p style="text-align: center;">[latex]
p_{ij} = w_j . r_{ij}
[/latex]</p>

<h3 style="text-align: left;">O algoritmo TOPSIS</h3>
O algoritmo do TOPSIS será descritos no passo a passo a seguir.

<strong>Passo 1: </strong>Identificar a solução ideal positiva $latex A^+$, para critérios de benefício, e a solução ideal negativa $latex A^-$, para critérios de custo, como mostrado a seguir:

[latex]
A^{+} = (p^{+}_{1}, p^{+}_{2}, \cdots , p^{+}_{n}) \\
A^{-} = (p^{-}_{1}, p^{-}_{2}, \cdots , p^{-}_{n})
[/latex]

onde:

[latex]

p_{j}^+ = \left\{\begin{matrix}
max_i (p_{ij}), \textrm{se o criterio e de beneficio}
\\
min_i (p_{ij}), \textrm{se o criterio e de custo}

\end{matrix}\right.

\\

\\

p_{j}^- = \left\{\begin{matrix}
min_i (p_{ij}), \textrm{se o criterio e de beneficio}
\\

max_i (p_{ij}), \textrm{se o criterio e de custo}

\end{matrix}\right.

[/latex]

&nbsp;

Em outras palavras, as equações acima escolhem os melhores desempenhos em cada critério, seja ele de custo (e nesse caso o melhor desempenho é o menor valor) ou de benefício (no qual o melhor desempenho é o maior valor), e monta os vetores $latex A^+$ e $latex A^-$, que nada mais são do que o desempenho para uma alternativa perfeita, ou seja, ter <em>ratings </em>altos para os critérios de benefícios e baixo para os de custo.

Uma outra maneira de obter os vetores ideais, é ao invés de escolher os valores máximos ou mínimos da matriz P, simplesmente é atribuído 1 ou 0 para criar a alternativa perfeita. Neste caso, no vetor ideal positivo $latex A^+$, os critérios de benefícios recebem valor 1 e de custo 0. Já no vetor ideal negativo $latex A^-$, a lógica inverte. Os critérios de benefícios recebem 0 e os de custo 1. Como alertei anteriormente,o conceito de custo e benefício é essencial para o TOPSIS funcionar corretamene.

<strong> Passo 2: </strong>Calcular, para cada alternativa $latex A_i$ a distancia euclidiana de cada <em>rating</em> para o vetor de soluções positivas $latex A^+$ e para o vetor de soluções ideias negativo $latex A^-$.

[latex]

d_{i}^{+} = \sqrt{\sum_{j=1}^{n} (d_{ij}^{+})^2}

\\

\\

d_{i}^{-} = \sqrt{\sum_{j=1}^{n} (d_{ij}^{-})^2}

[/latex]

onde $latex d_{i}^{+} = p_{j}^{+} - p_{ij}$ e $latex d_{i}^{-} = p_{j}^{-} - p_{ij}$.

&nbsp;

<strong>Passo 3:</strong> Calculado o as distâncias do passo anterior, o próximo passo é determinar a proximidade relativa $latex \xi $. A ideia é escolher como melhor alternativa aquela mais próxima da solução ideal positiva e mais distante da solução ideal negativa. Para isso, fazemos:

[latex]

\xi_i = \frac{d_{i}^{-}}{d_{i}^{+} + d_{i}^{-}}

[/latex]

&nbsp;

<strong>Passo 4: </strong>o último passo é fazer o ranking das alternativas baseada nos vetor $latex \xi $. As melhores alternativas são aquelas com os maiores valores de $latex \xi_i $ e devem ser escolhidas pois estão mais próximas da ideal.
<h3>Exemplo no MATLAB</h3>
Ao final deste post deixo linkado um código em MATLAB de um exemplo fictício baseado no nosso exemplo dos carros. Suponhamos que temos as 3 alternativas listadas na introdução: Pálio, HB20 e o Corola. Eles serão avaliados em 4 critérios: consumo (C), conforto (B), preço (C) e reputação da marca (B). Os pesos, que eu definir e cada tomador de decisão defini o seus próprios pesos, de cada critério, ou seja, o quão importante o critério é para mim, serão: consumo 30%, conforto 5%, preço 60% e reputação da marca 5%. A avaliação de cada carro, segundo os critérios é mostrado na matriz abaixo (cada alternativa e critério estão na mesma sequência). O consumo esta em litros a cada 100km, o conforto de 0 a 10, o preço em reais e a reputação de 0 a 10. Obviamente os valores são fictícios!

[latex]

D = \begin{pmatrix}
15 &amp; 6 &amp; 25000 &amp; 7\\
12 &amp; 7 &amp; 35000 &amp; 7 \\
10 &amp; 9 &amp; 55000 &amp; 8
\end{pmatrix}

[/latex]

&nbsp;

Nessa matriz é executado o TOPSIS (perceba que é importante a normalização, pois os valores estão em intervalos bem diferentes) e o resultado do raking final é mostrado na figura abaixo.

<a href="http://www.computacaointeligente.com.br/wp-content/uploads/2016/04/ranking.png"><img class="aligncenter  wp-image-355" src="http://www.computacaointeligente.com.br/wp-content/uploads/2016/04/ranking.png" alt="ranking" width="320" height="254" /></a>Os valores na lateral são os obtidos por $latex \xi_i $. Observe, que segundo os <em>ratings</em> e seus respectivos pesos, que eu atribuí, o melhor carro para mim é um Pálio (e realmente eu tenho um pálio rs). Se os valores dos pesos forem alterados o ranking pode sofrer alterações. Experimente fazer isso!

<a href="https://www.dropbox.com/s/68c6i4yfhr6dhgp/topsis.rar?dl=0" target="_blank">Download</a> código TOPSIS em MATLAB.

<a href="https://www.dropbox.com/s/iz5e86uzf5lr6dj/TOPSISpy.tar.gz?dl=0" target="_blank">Download</a> código TOPSIS em Python.
<h4>Referências</h4>
[1] R.E. Bellman, L.A. Zadeh, Decision-making in a fuzzy environment, Management Science 17 (1970) 141-164.

[2] C.L. Hwang &amp; K.P. Yoon, Multiple Attributes Decision Making Methods and Applications, Springer-
Verlag, Berlin, 1981.

[3] L.F.A.M. Gomes, L.A.D. Rangel, An application of the TODIM method to the multicriteria rental evaluation of residential properties, European Journal of Operational Research 193 (2009) 204-211.

[4] Krohling, Renato A., and Vinicius C. Campanharo. "Fuzzy TOPSIS for group decision making: A case study for accidents with oil spill in the sea." <i>Expert Systems with Applications</i> 38.4 (2011): 4190-4197.

[5] Krohling, Renato A., André GC Pacheco, and André LT Siviero. "IF-TODIM: An intuitionistic fuzzy TODIM to multi-criteria decision making." <i>Knowledge-Based Systems</i> 53 (2013): 142-146.<a href="http://www.computacaointeligente.com.br/wp-content/uploads/2016/04/ranking.png">
</a>